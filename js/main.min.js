function getData(){var e=$.ajax({url:"../file/locations.json",type:"GET"});e.done(function(e){locations=e,createCards(locations),$.when(createCards()).done(function(){stickyHeader()})}),e.fail(function(e,a,i){alert(i),alert(a)})}function createCards(e){for(var a in e){var i=e[a];$(".business-cards").append('<li class=" border-box  flex flex-300 m1 center card-border"><div class="flex-card flex flex-column" style="max-width: calc(90% - 20px); margin:0 auto;"><div class="center m1 styled-border-bottom"><div class="mt2 '+i.logo+'"></div></div><div class="flex-card-text flex flex-column flex-grow"><p class="h3">'+i.description+'</p><div class="address flex-grow"><div class="h2">'+i.address+'</div><div class="h3 mb2">'+i.time+'</div></div><div class="m1"><a href="'+i.link+'" target="_blank" class="btn h4 btn-outline styled-btn mb1 pb0">Visit website</a></div></div></div></li>')}}function loadMap(){var e={beer:{name:"Beer",icon:"images/beericon.png"},spirits:{name:"Spirits",icon:"images/martini.png"}},a=[],i=new google.maps.InfoWindow;getMarkerData(e,a,i)}function initializeMap(){map=new google.maps.Map(document.getElementById("map"),{zoom:15,scrollwheel:!1,mapTypeControl:!1,center:new google.maps.LatLng(46.8709932,-113.9995003),mapTypeId:google.maps.MapTypeId.ROADMAP})}function getMarkerData(e,a,i){var t=$.ajax({url:"../file/locations.json",type:"GET"});t.done(function(t){locations=t,initializeMap(),createMarkers(locations,e,a,i),createMapList(locations,a)}),t.fail(function(e,a,i){alert(i),alert(a)})}function createMarkers(e,a,i,t){for(var n in e){var o=e[n],s=o.lat,l=o.lng,r=new google.maps.LatLng(s,l),c=new google.maps.Marker({position:r,icon:a[o.type].icon,map:map,title:o.title,info:'<div class="list-location-title"><a href="https://www.google.com/maps/dir/Current+Location/'+o.title+'">'+o.title+"</a></div>"});google.maps.event.addListener(c,"click",function(){t.setContent(this.info),t.open(map,this)}),i.push(c)}}function createMapList(e,a){function i(e){var a=e.split(","),i=new google.maps.LatLng(a[0],a[1]);map.panTo(i)}for(var t in e){var n=e[t];$(".businessList").append('<li class="lato"><a class="business flex flex-center" alt="image marker icon" data-location='+n.lat+","+n.lng+" data-id="+n.id+'><div class="flex-auto lh1 px1"><div class="h2">'+n.title+'</div><div class="h3">'+n.address+"</div></div></a></li>")}$(".business").on("click",function(){var e=$(this).data("id"),t=$(this).data("location");i(t),google.maps.event.trigger(a[e],"click")})}function initializeScroll(){$("a[href*=#]:not([href=#])").click(function(){if(location.pathname.replace(/^\//,"")==this.pathname.replace(/^\//,"")&&location.hostname==this.hostname){var e=$(this.hash);if(e=e.length?e:$("[name="+this.hash.slice(1)+"]"),e.length)return $("html,body").animate({scrollTop:e.offset().top-50},1e3),!1}})}function getInstafeed(){var e=new Instafeed({get:"tagged",tagName:"mslatrail",userId:"2238867185",limit:"10",accessToken:"2238867185.467ede5.6ab6ee75da4c4655b6d8062734170ba6",template:'<li class="instagram-image inline left"><a href="{{link}}" target="_blank"><img src="{{image}}" /></a></li>'});e.run()}function replaceSvg(){jQuery("img.svg").each(function(){var e=jQuery(this),a=e.attr("id"),i=e.attr("class"),t=e.attr("src");jQuery.get(t,function(t){var n=jQuery(t).find("svg");"undefined"!=typeof a&&(n=n.attr("id",a)),"undefined"!=typeof i&&(n=n.attr("class",i+" replaced-svg")),n=n.removeAttr("xmlns:a"),e.replaceWith(n)},"xml")})}function stickyHeader(){$(window).bind("scroll",function(){var e=$(window).height()-300;$(window).scrollTop()>e?($(".nav-menu").addClass("navbar-fixed"),$(".passport-button").addClass("passport-fixed")):($(".nav-menu").removeClass("navbar-fixed"),$(".passport-button").removeClass("passport-fixed"))})}function initializeVideo(){if(window.jQuery)$(document).ready(function(){$("html").addClass("js");var e=$(".video-bg video");e.each(function(){$(this)[0].currentTime>0?$(this).addClass("is-playing"):$(this).on("playing",function(){$(this).addClass("is-playing")})});var a=/iPad|iPhone|iPod/.test(navigator.platform)||/iPad|iPhone|iPod/.test(navigator.userAgent);a&&$(".video-bg video").remove()});else{document.documentElement.className+=" js";var e=document.querySelectorAll(".video-bg video");for(i=0;i<e.length;i++)e[i].currentTime>0?e[i].className+=" is-playing":e[i].addEventListener("playing",function(){this.className.indexOf("is-playing")<0&&(this.className+=" is-playing")});var a=/iPad|iPhone|iPod/.test(navigator.platform);if(a){var t=document.querySelectorAll(".video-bg video");for(i=0;i<t.length;i++)t[i].parentNode.removeChild(t[i])}}}function animateElement(){function e(){var e=i.height(),t=i.scrollTop(),n=t+e;$.each(a,function(){var e=$(this),a=e.outerHeight(),i=e.offset().top,o=i+a;o>=t&&n>=i?e.addClass("in-view"):e.removeClass("in-view")})}var a=$(".animation-element"),i=$(window);i.on("scroll resize",e),i.trigger("scroll")}$(function(){initializeVideo(),replaceSvg(),getData(),initializeScroll(),animateElement(),getInstafeed(),loadMap()});